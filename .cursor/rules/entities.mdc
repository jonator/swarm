---
description: Diagram of resources users have access to for viewing the activity of Swarm AI coding agents and their connected GitHub organizations, repositories, and pull requests
globs: 
alwaysApply: false
---
erDiagram
    User {
        int ID PK
        string email
        string username
    }
    Organization {
        int ID PK
        string Name
        int GithubInstallationId
    }
    Repository {
        int ID PK
        string Owner
        string Name
        string ExternalId
        int OrganizationId FK
    }
    Project {
        int ID PK
        string RootDir
        string Type
        string Name
        int RepositoryId FK
    }
    Agent {
        uuid ID PK
        string Name
        text Context
        string Status
        string Source
        string Type
        map ExternalIds
        datetime StartedAt
        datetime CompletedAt
        int ObanJobId FK
        int UserId FK
        int RepositoryId FK
        int ProjectId FK
        datetime InsertedAt
        datetime UpdatedAt
    }
    AgentMessage {
        int ID PK
        int AgentId FK
        string Type
        text Content
        datetime InsertedAt
        datetime UpdatedAt
    }
    UsersOrganizations {
        int UserId FK
        int OrganizationId FK
        string Role
    }

    User ||--o{ UsersOrganizations : has
    Organization ||--o{ UsersOrganizations : has
    Organization ||--o{ Repository : has
    Repository ||--o{ Project : has
    User ||--o{ Agent : owns
    Repository ||--o{ Agent : contains
    Project ||--o{ Agent : scoped_to
    Agent ||--o{ AgentMessage : generates

    %% Note: Each user may have a "personal organization" (an Organization with only them as a member)